FROM ubuntu:20.04
ENV DEBIAN_FRONTEND noninteractve

# install monetdb build dependencies
RUN apt-get update && \
    apt-get install -y cmake python3-dev python3-pip curl

# download and extract monetdb
RUN mkdir /build 
WORKDIR /build 
RUN curl -O https://dev.monetdb.org/hg/MonetDB/archive/default.tar.bz2 
RUN tar jxvf default.tar.bz2 
RUN mkdir /build/MonetDB-default/build 
WORKDIR /build/MonetDB-default/build 
RUN apt-get install -y bison libpcre3-dev
RUN cmake .. 
RUN make -j 4 
RUN make install 

# preinstall dependencies
RUN pip3 install --upgrade pip pytest numpy pandas mypy pycodestyle

# add shared libraries to wheels
ENV LD_LIBRARY_PATH "${LD_LIBRARY_PATH}:/usr/local/lib"

